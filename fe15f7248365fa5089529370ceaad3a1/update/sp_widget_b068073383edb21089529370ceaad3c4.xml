<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope, $window) {
  var c = this;

  c.openRetro = function(sysId) {
    $window.location.href = '/sp?id=retro_view&sys_id=' + sysId;
  };

  c.openTask = function(sysId) {
    $window.location.href = '/sp?id=task_view&sys_id=' + sysId;
  };
}]]></client_script>
        <controller_as>c</controller_as>
        <css>.lists-container {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  margin-bottom: 30px;
}

.list-card {
  background: white;
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  overflow: hidden;
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
}

.list-card:hover {
  box-shadow: 0 4px 12px rgba(0,0,0,0.12);
}

.card-header {
  background: #f5f5f5;
  padding: 16px 14px;
  border-bottom: 1px solid #e0e0e0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
  flex-shrink: 0;
}

.card-title {
  color: #1a1a2e;
  font-size: 15px;
  font-weight: 600;
  margin: 0;
  word-break: break-word;
}

.card-count {
  background: #667eea;
  color: white;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 13px;
  flex-shrink: 0;
}

.card-body {
  padding: 0;
  max-height: 350px;
  overflow-y: auto;
  flex: 1;
}

.list-item {
  padding: 12px 14px;
  border-bottom: 1px solid #f0f0f0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  transition: background 0.2s ease;
  gap: 10px;
}

.list-item:hover {
  background: #f9f9ff;
}

.list-item.read-only {
  cursor: default;
}

.list-item.read-only:hover {
  background: white;
}

.list-item:last-child {
  border-bottom: none;
}

.item-info {
  flex: 1;
  min-width: 0;
}

.item-info h4 {
  color: #1a1a2e;
  font-size: 13px;
  font-weight: 600;
  margin: 0 0 2px 0;
  word-break: break-word;
}

.item-info p {
  color: #999;
  font-size: 11px;
  margin: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.date-separator {
  margin: 0 3px;
}

.item-badge {
  display: inline-block;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 10px;
  font-weight: 600;
  text-transform: capitalize;
  white-space: nowrap;
  flex-shrink: 0;
}

.badge-submitted {
  background: #f3e8ff;
  color: #6b21a8;
}

.badge-valid {
  background: #d1fae5;
  color: #065f46;
}

.badge-pending {
  background: #fed7aa;
  color: #9a3412;
}

.badge-in_progress {
  background: #dbeafe;
  color: #1e40af;
}

.badge-completed {
  background: #d1fae5;
  color: #065f46;
}

.read-only-badge {
  font-size: 9px;
  background: #e0e7ff;
  color: #4f46e5;
  padding: 3px 6px;
  border-radius: 3px;
  font-weight: 600;
  text-transform: uppercase;
  flex-shrink: 0;
}

.empty-state {
  padding: 30px 15px;
  text-align: center;
  color: #999;
}

.empty-icon {
  font-size: 32px;
  margin-bottom: 8px;
  opacity: 0.5;
  display: block;
}

.empty-text {
  font-size: 12px;
  color: #999;
}

/* Scrollbar */
.card-body::-webkit-scrollbar {
  width: 4px;
}

.card-body::-webkit-scrollbar-track {
  background: #f1f1f1;
}

.card-body::-webkit-scrollbar-thumb {
  background: #667eea;
  border-radius: 2px;
}

/* TABLET: 768px - 1024px */
@media (max-width: 1024px) {
  .lists-container {
    grid-template-columns: 1fr;
    gap: 15px;
  }

  .card-header {
    padding: 14px 12px;
  }

  .card-title {
    font-size: 14px;
  }
}

/* MOBILE: Below 768px */
@media (max-width: 768px) {
  .lists-container {
    gap: 12px;
    margin-bottom: 20px;
  }

  .list-card {
    max-height: 300px;
  }

  .card-header {
    padding: 12px 10px;
  }

  .card-title {
    font-size: 13px;
  }

  .card-count {
    width: 28px;
    height: 28px;
    font-size: 12px;
  }

  .card-body {
    max-height: 250px;
  }

  .list-item {
    padding: 10px 10px;
  }

  .item-info h4 {
    font-size: 12px;
  }

  .item-info p {
    font-size: 10px;
  }

  .item-badge {
    font-size: 9px;
    padding: 2px 6px;
  }

  .read-only-badge {
    font-size: 8px;
    padding: 2px 4px;
  }

  .empty-state {
    padding: 20px 10px;
  }

  .empty-icon {
    font-size: 28px;
  }

  .empty-text {
    font-size: 11px;
  }
}

/* SMALL MOBILE: Below 480px */
@media (max-width: 480px) {
  .card-title {
    font-size: 12px;
  }

  .item-info p {
    font-size: 9px;
  }

  .empty-icon {
    font-size: 24px;
  }
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>lists_container</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>LISTS CONTAINER</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
  var user = gs.getUser();
  var userId = user.getID();

  // Resolve user's primary team from team member table
  var userTeamId = '';
  var tm = new GlideRecord('x_1865669_retrospe_team_member');
  tm.addQuery('user', userId);
  tm.addQuery('active', true);
  tm.setLimit(1);
  tm.query();
  if (tm.next()) {
    userTeamId = tm.team.toString();
  }

  // 1) My Retros
  var myRetros = [];
  var gr = new GlideRecord('x_1865669_retrospe_retrospective_submission');
  gr.addQuery('submitted_by', userId);
  gr.orderByDesc('submitted_date');
  gr.setLimit(10);
  gr.query();
  while (gr.next()) {
    myRetros.push({
      sys_id: gr.sys_id.toString(),
      number: gr.number.toString(),
      sprint: gr.sprint.getDisplayValue(),
      status: gr.status.toString(),
      submitted_date: gr.submitted_date.getDisplayValue()
    });
  }

  // 2) Team Retros
  var teamRetros = [];
  if (userTeamId) {
    gr = new GlideRecord('x_1865669_retrospe_retrospective_submission');
    gr.addQuery('team', userTeamId);
    gr.orderByDesc('submitted_date');
    gr.setLimit(10);
    gr.query();
    while (gr.next()) {
      teamRetros.push({
        sys_id: gr.sys_id.toString(),
        number: gr.number.toString(),
        sprint: gr.sprint.getDisplayValue(),
        submitted_by: gr.submitted_by.getDisplayValue(),
        status: gr.status.toString()
      });
    }
  }

  // 3) My Tasks
  var myTasks = [];
  gr = new GlideRecord('x_1865669_retrospe_retrospective_task');
  gr.addQuery('assigned_to', userId);
  gr.addQuery('state', '!=', 'completed');
  gr.addQuery('state', '!=', 'cancelled');
  gr.orderBy('priority');
  gr.setLimit(10);
  gr.query();
  while (gr.next()) {
    myTasks.push({
      sys_id: gr.sys_id.toString(),
      number: gr.number.toString(),
      short_description: gr.short_description.toString(),
      state: gr.state.toString()
    });
  }

  // 4) Team Tasks
  var teamTasks = [];
  if (userTeamId) {
    gr = new GlideRecord('x_1865669_retrospe_retrospective_task');
    gr.addQuery('team', userTeamId);
    gr.orderBy('state');
    gr.setLimit(10);
    gr.query();
    while (gr.next()) {
      teamTasks.push({
        sys_id: gr.sys_id.toString(),
        number: gr.number.toString(),
        short_description: gr.short_description.toString(),
        assigned_to: gr.assigned_to.getDisplayValue(),
        state: gr.state.toString()
      });
    }
  }

  data.myRetros = myRetros;
  data.teamRetros = teamRetros;
  data.myTasks = myTasks;
  data.teamTasks = teamTasks;
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-12-08 12:48:03</sys_created_on>
        <sys_id>b068073383edb21089529370ceaad3c4</sys_id>
        <sys_mod_count>3</sys_mod_count>
        <sys_name>LISTS CONTAINER</sys_name>
        <sys_package display_value="Retrospective Management" source="x_1865669_retrospe">fe15f7248365fa5089529370ceaad3a1</sys_package>
        <sys_policy/>
        <sys_scope display_value="Retrospective Management">fe15f7248365fa5089529370ceaad3a1</sys_scope>
        <sys_update_name>sp_widget_b068073383edb21089529370ceaad3c4</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-12-08 13:39:19</sys_updated_on>
        <template><![CDATA[<div class="lists-container">
  <!-- Column 1: My Retro Submissions -->
  <div class="list-card">
    <div class="card-header">
      <h3 class="card-title">]]>üìù<![CDATA[ My Retros</h3>
      <span class="card-count" ng-bind="data.myRetros.length"></span>
    </div>
    <div class="card-body">
      <div ng-repeat="retro in data.myRetros" class="list-item" ng-click="openRetro(retro.sys_id)">
        <div class="item-info">
          <h4 ng-bind="retro.number"></h4>
          <p><span ng-bind="retro.sprint"></span><span class="date-separator">‚Ä¢</span><span ng-bind="retro.submitted_date | date:'MMM d'"></span></p>
        </div>
        <span class="item-badge" ng-class="'badge-' + retro.status" ng-bind="retro.status"></span>
      </div>
      <div ng-if="data.myRetros.length === 0" class="empty-state">
        <div class="empty-icon">]]>üìã<![CDATA[</div>
        <div class="empty-text">No retrospectives yet</div>
      </div>
    </div>
  </div>
  
  <!-- Column 2: Team's Retro Submissions -->
  <div class="list-card">
    <div class="card-header">
      <h3 class="card-title">]]>üë•<![CDATA[ Team Retros</h3>
      <span class="card-count" ng-bind="data.teamRetros.length"></span>
    </div>
    <div class="card-body">
      <div ng-repeat="retro in data.teamRetros" class="list-item" ng-click="openRetro(retro.sys_id)">
        <div class="item-info">
          <h4 ng-bind="retro.number"></h4>
          <p><span ng-bind="retro.submitted_by"></span><span class="date-separator">‚Ä¢</span><span ng-bind="retro.sprint"></span></p>
        </div>
        <span class="read-only-badge">VIEW</span>
      </div>
      <div ng-if="data.teamRetros.length === 0" class="empty-state">
        <div class="empty-icon">]]>üë•<![CDATA[</div>
        <div class="empty-text">No team retros yet</div>
      </div>
    </div>
  </div>
  
  <!-- Column 3: My Action Items -->
  <div class="list-card">
    <div class="card-header">
      <h3 class="card-title">‚úÖ My Tasks</h3>
      <span class="card-count" ng-bind="data.myTasks.length"></span>
    </div>
    <div class="card-body">
      <div ng-repeat="task in data.myTasks" class="list-item" ng-click="openTask(task.sys_id)">
        <div class="item-info">
          <h4 ng-bind="task.number"></h4>
          <p ng-bind="task.short_description"></p>
        </div>
        <span class="item-badge" ng-class="'badge-' + task.state" ng-bind="task.state"></span>
      </div>
      <div ng-if="data.myTasks.length === 0" class="empty-state">
        <div class="empty-icon">‚úÖ</div>
        <div class="empty-text">No tasks assigned</div>
      </div>
    </div>
  </div>
  
  <!-- Column 4: Team's Action Items -->
  <div class="list-card">
    <div class="card-header">
      <h3 class="card-title">]]>üéØ<![CDATA[ Team Tasks</h3>
      <span class="card-count" ng-bind="data.teamTasks.length"></span>
    </div>
    <div class="card-body">
      <div ng-repeat="task in data.teamTasks" class="list-item read-only">
        <div class="item-info">
          <h4 ng-bind="task.number"></h4>
          <p><span ng-bind="task.assigned_to"></span><span class="date-separator">‚Ä¢</span><span ng-bind="task.short_description"></span></p>
        </div>
        <span class="read-only-badge">VIEW</span>
      </div>
      <div ng-if="data.teamTasks.length === 0" class="empty-state">
        <div class="empty-icon">]]>üéØ<![CDATA[</div>
        <div class="empty-text">No team tasks</div>
      </div>
    </div>
  </div>
</div>]]></template>
    </sp_widget>
</record_update>
